'use strict';(function(){let M=16/9,F=[],V=a=>{F=[...F,a];return()=>{F=F.filter(b=>b!==a)}},ma=()=>{F.forEach(a=>a());F=[]},N=[],Q=(a,b,n,g)=>{const d=a.on(b,n,g);N=[...N,d];a=()=>{d();N=N.filter(A=>A!==d)};V(a);return a},W=a=>{var b;return null===(b=a._do_not_use_8d7d83cd2395d780b51b.rootNode)||void 0===b?void 0:b.querySelector(".dailymotion-player-wrapper")},X=a=>{var b;return null===(b=a._do_not_use_8d7d83cd2395d780b51b.rootNode)||void 0===b?void 0:b.querySelector(".dailymotion-player")},c={state:{},
prevState:{},defaultState:{isRunning:!1,displayMode:null,isSmallViewportDisplay:!1,isExpanded:!1,isPipCustomPosition:!1,hasPipBanner:!1,hasRequestedPipNative:!1,uiActionOrigin:null,playerSelectedForPip:null,playerSelectedForPipNative:null,pipPositionX:null,pipPositionY:null,pipTransformSmallViewportCollapsed:null},nonPersistentStateProps:["uiActionOrigin"],onStateChange(){},setState(a){this.nonPersistentStateProps.forEach(b=>{Object.prototype.hasOwnProperty.call(a,b)||(a={...a,[b]:this.defaultState[b]})});
this.prevState={...this.prevState,...this.state};this.state={...this.state,...a};this.onStateChange(this.prevState,this.state)}},u=null,J=!1,G=!1,B=null,R=Object.values(window.dailymotion._do_not_use_8d7d83cd2395d780b51b.players);for(let a=0;a<R.length;a++)if("off"!==R[a]._do_not_use_8d7d83cd2395d780b51b.settings.pip){J=R[a]._do_not_use_8d7d83cd2395d780b51b.settings.enableStartPipExpanded;break}let h=()=>window.innerWidth<=_dmpesplayer.B.SMALL?"small":"large",Y=a=>"small"!==h()?!1:u||null===u&&J||
G||(null===a||void 0===a?0:a.adIsPlaying)?!0:!1,oa=(a,b)=>{const n=d=>{d&&c.setState({isExpanded:Y(),displayMode:h(),isSmallViewportDisplay:"small"===h()});H(a)};na(a,b);Q(a,_dmpesplayer.a.PUBLIC.VIDEO_PLAY,()=>{c.setState({hasPipBanner:a.getSettings().enableGooglePolicyUi&&a.getSettings().enablePlaybackControls})});n();const g=_dmpesplayer.b(window,"resize",n);V(()=>{g();Z(a);document.body.offsetWidth;B&&(B(),B=null)})},O=(a,b,n)=>{c.state.isRunning&&!G&&(u=b?!0:!1,c.setState({hasPipBanner:a.getSettings().enableGooglePolicyUi&&
a.getSettings().enablePlaybackControls,isExpanded:u,uiActionOrigin:n}),H(a,{animate:!1}))},H=function(a){let {animate:b=!1,computePlayerIframeSizes:n=!0}=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Z(a,{animate:b,computePlayerIframeSizes:n});const g=a._do_not_use_8d7d83cd2395d780b51b.rootNode,d=W(a),A=X(a),e=(u||null===u&&J?!0:!1)||G,k=c.state.hasPipBanner,{dynamicWidth:t,dynamicHeight:p}=pa(),q=document.documentElement.clientWidth,l=Math.round(q/M)+(k?32:0);d.id=`dailymotion-pip-${h()}-viewport`;
const {defaultPositionX:I,defaultPositionY:K,defaultMargin:v}={large:{defaultPositionX:"right",defaultPositionY:"bottom",defaultMargin:"20px"},small:{defaultPositionX:"left",defaultPositionY:"top",defaultMargin:"0px"}}[h()],m=r=>getComputedStyle(document.querySelector(`#${d.id}`)).getPropertyValue(r);var f=r=>""!==m(`--position-${r}`).trim();f("top")||f("bottom")||d.style.setProperty(`--position-${K}`,v);f("left")||f("right")||d.style.setProperty(`--position-${I}`,v);!f("bottom")&&B&&(B(),B=null);
f("bottom")&&"small"===h()&&!B&&(B=_dmpesplayer.b(window,"scroll",()=>{H(a,{computePlayerIframeSizes:!1})}));const S="small"===h()&&(f("bottom")||f("right")||m("--position-top")!==v||m("--position-left")!==v),T=f("left")||f("top")||m("--position-bottom")!==v||m("--position-right")!==v,w=f("left")?"left":"right",C=f("top")?"top":"bottom",D=getComputedStyle(d);Object.assign(d.style,{boxShadow:"0 0.25rem 0.5rem rgba(0, 0, 0, 0.2)",height:`${"large"===h()?k?p+32:p:e?l:k?136:104}px`,position:"fixed",transform:(()=>
{for(var r=[],z=d.parentNode;z!==document&&z;)r.push(z),z=z.parentNode;z=document.documentElement.scrollLeft?document.documentElement.scrollLeft:r.reduce((L,x)=>{({scrollLeft:x}=x);return L+x},0);r=document.documentElement.scrollTop?document.documentElement.scrollTop:r.reduce((L,x)=>{({scrollTop:x}=x);return L+x},0);let y;"rtl"===D.direction?("right"===w&&(y=document.documentElement.clientWidth),"left"===w&&(y="large"===h()?t:q),y-=g.getBoundingClientRect().right):("right"===w&&(y=document.documentElement.clientWidth-
("large"===h()?t:q)),"left"===w&&(y=0),y-=g.getBoundingClientRect().left);y-=z;let E;"bottom"===C&&(E=window.innerHeight-("large"===h()?k?p+32:p:e?l:k?136:104));"top"===C&&(E=0);E=E-g.getBoundingClientRect().top-r;r="bottom"===C?"-":"+";return`translate(
      calc(${y}px ${"right"===w?"-":"+"} ${"0.00001"!==parseFloat(D.marginRight).toPrecision(1)?`${parseFloat(D.marginRight)}px`:"left"!==w||isNaN(m("--position-left").trim())?"right"!==w||isNaN(m("--position-right").trim())?`var(--position-${w})`:`${Number(m("--position-right"))}px`:`${Number(m("--position-left"))}px`}),
      calc(${E}px ${r} ${"0.00001"!==parseFloat(D.marginBottom).toPrecision(1)?`${parseFloat(D.marginBottom)}px`:"top"!==C||isNaN(m("--position-top").trim())?"bottom"!==C||isNaN(m("--position-bottom").trim())?`var(--position-${C})`:`${Number(m("--position-bottom"))}px`:`${Number(m("--position-top"))}px`})
    )`})(),transition:"none",width:`${"large"===h()?t:q}px`,zIndex:2147483647,bottom:"unset",left:"unset",right:"unset",top:"unset",borderRadius:`${"large"===h()?"0.5rem":"0rem"}`});f=null;"small"===h()&&(Object.assign(A,{height:`${l}px`,width:`${q}px`}),f=Math.round((l-104)/2),Object.assign(A.style,{height:`${l}px`,transition:"none",transform:e?"translate(0px,0px)":`translate(0px, -${f}px)`,width:`${q}px`}));c.setState({isPipCustomPosition:S||T,pipPositionX:d.getBoundingClientRect().x,pipPositionY:d.getBoundingClientRect().y,
uiActionOrigin:c.state.uiActionOrigin,pipTransformSmallViewportCollapsed:f})},Z=function(a){let {animate:b=!1,computePlayerIframeSizes:n=!0}=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};const g=W(a),d=X(a);g.removeAttribute("id");g.style.removeProperty("--position-top");g.style.removeProperty("--position-left");g.style.removeProperty("--position-bottom");g.style.removeProperty("--position-right");Object.assign(g.style,{boxShadow:"unset",...(b?{}:{height:"100%"}),position:"absolute",transform:"translate(0px,0px)",
width:"100%",zIndex:"auto",margin:"0.00001px",borderRadius:"0px"});n&&(Object.assign(d,{height:"100%",width:"100%"}),Object.assign(d.style,{height:"100%",transform:"translate(0px,0px)",transition:"none",width:"100%"}))},pa=()=>{var a=window.innerWidth;if(a<=_dmpesplayer.B.MEDIUM)return{dynamicWidth:410,dynamicHeight:Math.round(410/M)};if(a>=_dmpesplayer.B.LARGE)return{dynamicWidth:560,dynamicHeight:Math.round(560/M)};const b=_dmpesplayer.B.LARGE-_dmpesplayer.B.MEDIUM;a=Math.round((a-_dmpesplayer.B.LARGE+
b)/b*150)+410;return{dynamicWidth:a,dynamicHeight:Math.round(a/M)}},na=(a,b)=>{(G=b.adIsPlaying)?aa(a):ba(a)},ba=a=>{Q(a,_dmpesplayer.a.PUBLIC.AD_START,()=>{G=!0;c.setState({hasPipBanner:a.getSettings().enableGooglePolicyUi&&a.getSettings().enableAdsControls});u||null===u&&J||c.setState({isExpanded:"small"===h()});H(a);aa(a)},{once:!0})},aa=a=>{Q(a,_dmpesplayer.a.PUBLIC.AD_END,()=>{G=!1;c.setState({hasPipBanner:a.getSettings().enableGooglePolicyUi&&a.getSettings().enablePlaybackControls});u||null===
u&&J||c.setState({isExpanded:!1});H(a);ba(a)},{once:!0})},U=()=>{},P=()=>{},qa=()=>{c.setState({...c.defaultState});U=e=>{a();b();n();g();d();A();P(e)};const a=_dmpesplayer.d(_dmpesplayer.a.PUBLIC.PLAYER_VIEWABILITYCHANGE,e=>{let {viewable:k,wasViewableAtLeastOnce:t,id:p,uiActionOrigin:q}=e;const l=window.dailymotion._do_not_use_8d7d83cd2395d780b51b.players[p];if(l&&"off"!==l._do_not_use_8d7d83cd2395d780b51b.settings.pip&&!(c.state.playerSelectedForPip&&l!==c.state.playerSelectedForPip||c.state.playerSelectedForPipNative)){var {status:I,
reason:K}=l.isEligibleForPipDisplay(t);_dmpesplayer.l.log("PiP",`Viewability change received
        - is player viewable : ${k}
        - is player eligible for PIP display : ${I} (${K})`);k?P(q||"scroll"):!k&&l.isEligibleForPipDisplay(t).status&&l.getState().then(v=>{ca(l,v,t||"instant"!==l._do_not_use_8d7d83cd2395d780b51b.settings.pip?"scroll":"instant_start")})}}),b=_dmpesplayer.d(_dmpesplayer.a.PUBLIC.PLAYER_PRESENTATION_MODE_CHANGE,e=>{let {playerPresentationMode:k,id:t}=e;const p=window.dailymotion._do_not_use_8d7d83cd2395d780b51b.players[t];p&&("inline"===k&&c.state.playerSelectedForPipNative===p&&c.setState({playerSelectedForPipNative:null}),
"nativePip"===k?(c.setState({playerSelectedForPipNative:p}),c.state.hasRequestedPipNative&&c.setState({hasRequestedPipNative:!1}),c.state.playerSelectedForPip&&P("pip_native_icon")):p.getState().then(q=>{q.playerIsViewable||ca(p,q,"pip_native_icon")}))}),n=_dmpesplayer.d(_dmpesplayer.a.PRIVATE.CLOSE_PIP_REQUESTED,()=>{U("close_icon")}),g=_dmpesplayer.d(_dmpesplayer.a.PRIVATE.BACK_TO_INLINE_DISPLAY_REQUESTED,()=>{const e=c.state.playerSelectedForPip,{observer:k}=e._do_not_use_8d7d83cd2395d780b51b;
k.setUIActionOrigin("back_icon");e._do_not_use_8d7d83cd2395d780b51b.rootNode.scrollIntoView({block:"start"})}),d=_dmpesplayer.d(_dmpesplayer.a.PRIVATE.COLLAPSE_PIP_REQUESTED,()=>{O(c.state.playerSelectedForPip,!1,"toggle_icon")}),A=_dmpesplayer.d(_dmpesplayer.a.PRIVATE.EXPAND_PIP_REQUESTED,()=>{O(c.state.playerSelectedForPip,!0,"toggle_icon")})},ca=(a,b,n)=>{if(!c.state.isRunning&&window.dailymotion._do_not_use_8d7d83cd2395d780b51b.playerSelectedForPip===a&&!c.state.playerSelectedForPipNative){P=
e=>{c.state.isRunning&&(ma(),c.setState({isPipCustomPosition:!1,isRunning:!1,hasPipBanner:!1,pipPositionX:null,pipPositionY:null,playerSelectedForPip:null,uiActionOrigin:e}),c.onStateChange=()=>{},"close_icon"!==e&&"api_call"!==e||a.pause())};c.onStateChange=(e,k)=>{let {isRunning:t,isExpanded:p}=e,{displayMode:q,isRunning:l,isExpanded:I,uiActionOrigin:K,playerSelectedForPipNative:v}=k;const m={playerPipDisplay:`${q}Viewport`,playerPipIsExpanded:I,playerPipStatus:"close_icon"===K?"closed":"enabled",
playerPresentationMode:l?"pip":v?"nativePip":"inline"},{id:f,stateFromPES:S}=a._do_not_use_8d7d83cd2395d780b51b;Object.assign(S,m);t!==l&&_dmpesplayer.s(_dmpesplayer.a.PUBLIC.PLAYER_PRESENTATIONMODECHANGE,{id:f,...m});p!==I&&_dmpesplayer.s(_dmpesplayer.a.PUBLIC.PLAYER_PIPEXPANDEDCHANGE,{id:f,...m});let {isRunning:T,isSmallViewportDisplay:w,isExpanded:C,isPipCustomPosition:D,hasPipBanner:r,hasRequestedPipNative:z,pipPositionX:y,pipPositionY:E,pipTransformSmallViewportCollapsed:L}=e,{isRunning:x,isSmallViewportDisplay:da,
isExpanded:ea,isPipCustomPosition:fa,hasPipBanner:ha,hasRequestedPipNative:ia,uiActionOrigin:ra,pipPositionX:ja,pipPositionY:ka,pipTransformSmallViewportCollapsed:la}=k;if(T!==x||w!==da||C!==ea||r!==ha||D!==fa||z!==ia||y!==ja||E!==ka||L!==la)e={isRunning:x,isSmallViewportDisplay:da,isExpanded:ea,isPipCustomPosition:fa,hasPipBanner:ha,hasRequestedPipNative:ia,uiActionOrigin:ra,screenId:window.dailymotion._do_not_use_8d7d83cd2395d780b51b.screenId,pipPositionX:ja,pipPositionY:ka,pipTransformSmallViewportCollapsed:la},
_dmpesplayer.l.log("PipEmitter","Sending new PIP state to player :",e),_dmpesplayer.c(a,_dmpesplayer.C.NOTIFY_PIP_CHANGED,e)};var g=a.getSettings().enableGooglePolicyUi,d=!b.adIsPlaying&&a.getSettings().enablePlaybackControls,A=b.adIsPlaying&&a.getSettings().enableAdsControls;c.setState({hasPipBanner:g&&(d||A),isRunning:!0,uiActionOrigin:n,displayMode:h(),isSmallViewportDisplay:"small"===h(),isExpanded:Y(b),playerSelectedForPip:a});oa(a,b)}};window.dailymotion.pipResume=()=>{qa()};window.dailymotion.pipClose=
()=>{U("api_call")};window.dailymotion.pipExpand=()=>{O(c.state.playerSelectedForPip,!0,"api_call")};window.dailymotion.pipCollapse=()=>{O(c.state.playerSelectedForPip,!1,"api_call")};window.dailymotion.pipRepaint=()=>{H(c.state.playerSelectedForPip)}})()
